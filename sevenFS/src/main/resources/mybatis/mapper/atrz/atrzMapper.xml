<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.sevenfs.mapper.atrz.AtrzMapper">
	<!--home 결재대기문서 -->
		<!-- 결재 대기중인 문서리스트 (결재대기문서)-->
	<select id="homeAtrzApprovalList" resultMap="atrzMap">
		WITH my_turn_lines AS (					/* AtrzMapper.atrzApprovalList */
		    SELECT L.*
		    FROM atrz_line L
		    WHERE L.sanctner_empno = #{emplNo}
		      AND L.sanctn_progrs_sttus_code = '00'
		      AND L.atrz_ty = '1'
		      AND NOT EXISTS (
		          SELECT 1
		          FROM atrz_line L2
		          WHERE L2.atrz_doc_no = L.atrz_doc_no
		            AND L2.atrz_ln_sn &lt; L.atrz_ln_sn
		            AND L2.atrz_ty = '1'
		            AND L2.sanctn_progrs_sttus_code NOT IN ('10', '60')
		      )
		)
		SELECT  
		      A.atrz_doc_no
		      ,A.drafter_empno
		      ,A.drafter_clsf
		      ,A.drafter_empnm
		      ,A.drafter_dept
		      ,A.bkmk_yn
		      ,A.atch_file_no
		      ,A.atrz_sj
		      ,A.atrz_cn
		      ,A.atrz_opinion
		      ,A.atrz_tmpr_stre_dt
		      ,A.atrz_drft_dt
		      ,A.atrz_compt_dt
		      ,A.atrz_rtrvl_dt
		      ,A.atrz_sttus_code
		      ,A.eltsgn_image
		      ,A.doc_form_no
		      ,A.atrz_delete_yn
		      ,A.schdul_reg_yn
		      ,L.atrz_ln_sn
		      ,L.sanctner_empno
		      ,L.sanctn_progrs_sttus_code
		      ,L.atrz_ty
		      ,L.dcrb_author_yn
		      ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
          	  ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ A
		JOIN my_turn_lines L
		  ON A.atrz_doc_no = L.atrz_doc_no
		WHERE A.atrz_compt_dt IS NULL
			AND A.atrz_sttus_code IS NOT NULL
			AND A.atrz_sttus_code = '00'
			AND A.atrz_sttus_code != '99'
		ORDER BY A.atrz_drft_dt DESC
	</select>
	
	<!-- 결재 대기중인 문서리스트 (결재대기문서)-->
	<select id="atrzApprovalList" parameterType="hashMap" resultMap="atrzMap">
		SELECT U.*
		FROM
		(
			WITH my_turn_lines AS (					/* AtrzMapper.atrzApprovalList */
			    SELECT L.*
			    FROM atrz_line L
			    WHERE L.sanctner_empno = #{emplNo}
			      AND L.sanctn_progrs_sttus_code = '00'
			      AND L.atrz_ty = '1'
			      AND NOT EXISTS (
			          SELECT 1
			          FROM atrz_line L2
			          WHERE L2.atrz_doc_no = L.atrz_doc_no
			            AND L2.atrz_ln_sn &lt; L.atrz_ln_sn
			            AND L2.atrz_ty = '1'
			            AND L2.sanctn_progrs_sttus_code NOT IN ('10', '60')
			      )
			)
			SELECT  ROW_NUMBER() OVER(ORDER BY A.atrz_drft_dt DESC) RNUM
			      ,A.atrz_doc_no
			      ,A.drafter_empno
			      ,A.drafter_clsf
			      ,A.drafter_empnm
			      ,A.drafter_dept
			      ,A.bkmk_yn
			      ,A.atch_file_no
			      ,A.atrz_sj
			      ,A.atrz_cn
			      ,A.atrz_opinion
			      ,A.atrz_tmpr_stre_dt
			      ,A.atrz_drft_dt
			      ,A.atrz_compt_dt
			      ,A.atrz_rtrvl_dt
			      ,A.atrz_sttus_code
			      ,A.eltsgn_image
			      ,A.doc_form_no
			      ,A.atrz_delete_yn
			      ,A.schdul_reg_yn
			      ,L.atrz_ln_sn
			      ,L.sanctner_empno
			      ,L.sanctn_progrs_sttus_code
			      ,L.atrz_ty
			      ,L.dcrb_author_yn
			      ,DF.DOC_FORM_NM
			      ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
	          	  ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
			FROM ATRZ A
			JOIN my_turn_lines L ON A.atrz_doc_no = L.atrz_doc_no
			LEFT JOIN DOC_FORM DF ON A.doc_form_no = DF.DOC_FORM_NO
			WHERE A.atrz_compt_dt IS NULL
				AND A.atrz_sttus_code IS NOT NULL
				AND A.atrz_sttus_code = '00'
			<!-- 검색조건 -->
			<if test="keyword != null and keyword != ''">
			    <choose>
			        <when test="searchType == 'title'">
			            AND A.atrz_sj LIKE '%' || #{keyword} || '%'
			        </when>
			        <when test="searchType == 'drafterName'">
			            AND A.drafter_empnm LIKE '%' || #{keyword} || '%'
			        </when>
			        <when test="searchType == 'drafterDeptName'">
			           AND (SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = A.drafter_dept)
        				LIKE '%' || #{keyword} || '%'
			        </when>
			        <when test="searchType == 'formName'">
			            AND DF.DOC_FORM_NM LIKE '%' || #{keyword} || '%'
			            <!-- 또는 결재양식명이 다른 테이블에서 조인된다면 거기서 가져오도록 처리 -->
			        </when>
			    </choose>
			</if>
			
			<!-- 날짜 필터
			{duration=all, fromDate=2025-04-22, size=10, searchType=title, toDate=2025-04-22, emplNo=20250004, currentPage=1, keyword=계란}
			 -->
			<if test="duration != null and duration != 'all'">
			    <choose>
			        <when test="duration == 'period'">
					    <if test="fromDate != null and fromDate != ''">
					        AND A.atrz_drft_dt <![CDATA[ >= ]]> TO_DATE(#{fromDate}, 'YYYY-MM-DD')
					    </if>
					    <if test="toDate != null and toDate != ''">
					        AND A.atrz_drft_dt <![CDATA[ <= ]]>TO_DATE(#{toDate}, 'YYYY-MM-DD') + 1
					    </if>
			        </when>
			        <when test="duration == '1'">
			            AND A.atrz_drft_dt <![CDATA[ >= ]]> ADD_MONTHS(SYSDATE, -1)
			        </when>
			        <when test="duration == '6'">
			            AND A.atrz_drft_dt <![CDATA[ >= ]]> ADD_MONTHS(SYSDATE, -6)
			        </when>
			        <when test="duration == '12'">
			            AND A.atrz_drft_dt <![CDATA[ >= ]]> ADD_MONTHS(SYSDATE, -12)
			        </when>
			    </choose>
			</if>	
		) U
		WHERE U.RNUM BETWEEN (#{currentPage}*10) - (10-1) AND (#{currentPage}*10)
	</select>
	
	<!-- 
	결재대기문서목록 행의 수
	public int approvalTotal(String emplNo)
	 -->
	<select id="approvalTotal" parameterType="hashMap" resultType="int">
		WITH my_turn_lines AS (					/* AtrzMapper.atrzApprovalList */
		    SELECT L.*
		    FROM atrz_line L
		    WHERE L.sanctner_empno = #{emplNo}
		      AND L.sanctn_progrs_sttus_code = '00'
		      AND L.atrz_ty = '1'
		      AND NOT EXISTS (
		          SELECT 1
		          FROM atrz_line L2
		          WHERE L2.atrz_doc_no = L.atrz_doc_no
		            AND L2.atrz_ln_sn &lt; L.atrz_ln_sn
		            AND L2.atrz_ty = '1'
		            AND L2.sanctn_progrs_sttus_code NOT IN ('10', '60')
		      )
		)
		SELECT  count(*)
		FROM ATRZ A
		JOIN my_turn_lines L
		  ON A.atrz_doc_no = L.atrz_doc_no
		WHERE A.atrz_compt_dt IS NULL
			AND A.atrz_sttus_code IS NOT NULL
			<!-- 검색 조건 -->
			<!-- 검색조건 -->
			<if test="keyword != null and keyword != ''">
			    <choose>
			        <when test="searchType == 'title'">
			            AND A.atrz_sj LIKE '%' || #{keyword} || '%'
			        </when>
			        <when test="searchType == 'drafterName'">
			            AND A.drafter_empnm LIKE '%' || #{keyword} || '%'
			        </when>
			        <when test="searchType == 'drafterDeptName'">
			           AND (SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = A.drafter_dept)
        				LIKE '%' || #{keyword} || '%'
			        </when>
			        <when test="searchType == 'formName'">
			            AND DF.DOC_FORM_NM LIKE '%' || #{keyword} || '%'
			            <!-- 또는 결재양식명이 다른 테이블에서 조인된다면 거기서 가져오도록 처리 -->
			        </when>
			    </choose>
			</if>
			<!-- 날짜 필터 -->
			<if test="duration != null and duration != 'all'">
			    <choose>
			        <when test="duration == 'period'">
					    <if test="fromDate != null and fromDate != ''">
					        AND A.atrz_drft_dt <![CDATA[ >= ]]> TO_DATE(#{fromDate}, 'YYYY-MM-DD')
					    </if>
					    <if test="toDate != null and toDate != ''">
					        AND A.atrz_drft_dt <![CDATA[ <= ]]>TO_DATE(#{toDate}, 'YYYY-MM-DD') + 1
					    </if>
			        </when>
			        <when test="duration == '1'">
			            AND A.atrz_drft_dt <![CDATA[ >= ]]> ADD_MONTHS(SYSDATE, -1)
			        </when>
			        <when test="duration == '6'">
			            AND A.atrz_drft_dt <![CDATA[ >= ]]> ADD_MONTHS(SYSDATE, -6)
			        </when>
			        <when test="duration == '12'">
			            AND A.atrz_drft_dt <![CDATA[ >= ]]> ADD_MONTHS(SYSDATE, -12)
			        </when>
			    </choose>
			</if>	
	</select>	
	
	<!-- 기안진행문서 최신순5개 -->
	<select id="atrzMinSubmitList" resultMap="atrzMap" parameterType="string">
		SELECT 		/* AtrzMapper.atrzMinSubmitList */
		       A.atrz_doc_no
		      ,A.drafter_empno
		      ,A.drafter_clsf
		      ,A.drafter_empnm
		      ,A.drafter_dept
		      ,A.bkmk_yn
		      ,A.atch_file_no
		      ,A.atrz_sj
		      ,A.atrz_cn
		      ,A.atrz_opinion
		      ,A.atrz_tmpr_stre_dt
		      ,A.atrz_drft_dt
		      ,A.atrz_compt_dt
		      ,A.atrz_rtrvl_dt
		      ,A.atrz_sttus_code
		      ,A.eltsgn_image
		      ,A.doc_form_no
		      ,A.atrz_delete_yn
		      ,A.schdul_reg_yn
		      ,L.atrz_ln_sn
		      ,L.sanctner_empno
		      ,L.sanctn_progrs_sttus_code
		      ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
		      ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		      
		FROM (
		    SELECT *
		    FROM (
		        SELECT *
		        FROM ATRZ
		        WHERE drafter_empno = #{emplNo}
		          AND atrz_delete_yn = 'N'
		          AND atrz_sttus_code = '00'
		        ORDER BY atrz_drft_dt DESC
		    )
		    WHERE ROWNUM &lt;= 5
		) A
		LEFT JOIN atrz_line L
		  ON A.atrz_doc_no = L.atrz_doc_no
		ORDER BY A.atrz_drft_dt DESC
	</select>
	
	<!-- 기안완료문서 최신순5개 -->
	<select id="atrzMinCompltedList" resultMap="atrzMap" parameterType="string">
		SELECT *   /* AtrzMapper.atrzMinCompltedList 쿼리수정완료 */
			FROM (
			  SELECT 	
			        A.atrz_doc_no
			        ,A.atrz_sj
			        ,A.atrz_cn
			        ,A.atrz_drft_dt
			        ,A.atrz_compt_dt
			        ,A.atrz_rtrvl_dt
			        ,A.atrz_sttus_code
			        ,A.drafter_empno
			        ,A.drafter_empnm
			        ,A.drafter_clsf
			        ,A.drafter_dept
			        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
          			,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
			    FROM ATRZ A
			    WHERE A.drafter_empno = #{emplNo}
			      AND A.atrz_sttus_code = '10'
			    ORDER BY A.atrz_compt_dt DESC
			)
			WHERE ROWNUM &lt;= 5
	</select>
	
	
	<!-- 기안중인 문서리스트 문서리스트 (기안진행문서) -->
	<select id="atrzSubmitList" resultMap="atrzMap" parameterType="string">
		SELECT 	/* AtrzMapper.atrzSubmitList 쿼리수정완료 */
	        A.atrz_doc_no
	        ,A.atrz_sj
	        ,A.atrz_cn
	        ,A.atrz_drft_dt
	        ,A.atrz_compt_dt
	        ,A.atrz_rtrvl_dt
	        ,A.atrz_sttus_code
	        ,A.drafter_empno
	        ,A.drafter_empnm
	        ,A.drafter_clsf
	        ,A.drafter_dept
	        ,L.atrz_ln_sn
	        ,L.sanctner_empno
	        ,L.sanctn_progrs_sttus_code
	        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
            ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
	    FROM ATRZ A
	    LEFT JOIN atrz_line L
	        on A.atrz_doc_no = L.atrz_doc_no
	    WHERE 1 = 1
	     AND A.drafter_empno = #{emplNo}
	     AND A.atrz_sttus_code = '00'
	    ORDER BY A.atrz_drft_dt DESC
	</select>
	
	<!-- 기안완료된 문서리스트(결재완료문서) -->
	<select id="atrzCompletedList" resultMap="atrzMap" parameterType="string">
        SELECT 	/* AtrzMapper.atrzCompletedList 쿼리수정완료 */
	         A.atrz_doc_no
	        ,A.atrz_sj
	        ,A.atrz_cn
	        ,A.atrz_drft_dt
	        ,A.atrz_compt_dt
	        ,A.atrz_rtrvl_dt
	        ,A.atrz_sttus_code
	        ,A.drafter_empno
	        ,A.drafter_empnm
	        ,A.drafter_clsf
	        ,A.drafter_dept
	        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
            ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
	    FROM ATRZ A
	    WHERE  1 = 1
	      AND A.drafter_empno = #{emplNo}
	      AND A.atrz_sttus_code = '10'
	    ORDER BY A.atrz_compt_dt DESC
	</select>
	
	<!-- 참조대기문서 -->
	<select id="atrzReferList" resultMap="atrzMap" parameterType="string">
		SELECT 		/* AtrzMapper.atrzReferList 쿼리수정완료 */ 
		       A.atrz_doc_no
		       ,A.drafter_empno
		       ,A.drafter_clsf
		       ,A.drafter_empnm
		       ,A.drafter_dept
		       ,A.bkmk_yn
		       ,A.atch_file_no
		       ,A.atrz_sj
		       ,A.atrz_cn
		       ,A.atrz_opinion
		       ,A.atrz_tmpr_stre_dt
		       ,A.atrz_drft_dt
		       ,A.atrz_compt_dt
		       ,A.atrz_rtrvl_dt
		       ,A.atrz_sttus_code
		       ,A.eltsgn_image
		       ,A.doc_form_no
		       ,A.atrz_delete_yn
		       ,A.schdul_reg_yn
		       ,L.atrz_ln_sn
		       ,L.sanctner_empno
		       ,L.atrz_ty
		       ,L.sanctn_progrs_sttus_code
		       ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
               ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		  FROM ATRZ A
		  LEFT JOIN atrz_line L
		    ON A.atrz_doc_no = L.atrz_doc_no
		 WHERE 1 = 1 
		   AND A.atrz_delete_yn = 'N'
		   AND A.atrz_sttus_code = '00'         
		   AND L.sanctner_empno = #{emplNo}      
		   AND L.atrz_ty = '0'                  
		 ORDER BY A.atrz_drft_dt DESC
	</select>
	<!-- 결재예정문서 -->
	<select id="atrzExpectedList" resultMap="atrzMap" parameterType="string">
		SELECT  /* AtrzMapper.atrzExpectedList */ 
		        A.atrz_doc_no
		       ,A.drafter_empno
		       ,A.drafter_clsf
		       ,A.drafter_empnm
		       ,A.drafter_dept
		       ,A.bkmk_yn
		       ,A.atch_file_no
		       ,A.atrz_sj
		       ,A.atrz_cn
		       ,A.atrz_opinion
		       ,A.atrz_tmpr_stre_dt
		       ,A.atrz_drft_dt
		       ,A.atrz_compt_dt
		       ,A.atrz_rtrvl_dt
		       ,A.atrz_sttus_code
		       ,A.eltsgn_image
		       ,A.doc_form_no
		       ,A.atrz_delete_yn
		       ,A.schdul_reg_yn
		       ,L.atrz_ln_sn
		       ,L.sanctner_empno
		       ,L.sanctn_progrs_sttus_code
		       ,L.atrz_ty
		       ,L.dcrb_author_yn
		       ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
               ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ A
		     LEFT JOIN atrz_line L ON A.atrz_doc_no = L.atrz_doc_no
		WHERE 1 = 1
		  AND A.atrz_compt_dt IS NULL
		  AND A.atrz_sttus_code = '00'
		  AND L.sanctner_empno = #{emplNo}
		  AND L.atrz_ty = '1'
		  AND EXISTS (
		      SELECT 1
		      FROM atrz_line L2
		      WHERE L2.atrz_doc_no = A.atrz_doc_no
		        AND L2.atrz_ln_sn &lt; L.atrz_ln_sn
		        AND L2.atrz_ty = '1'
		        AND L2.sanctn_progrs_sttus_code = '00'
		  )
		ORDER BY A.atrz_drft_dt DESC
	</select>
	
	<!-- 기안문서함 -->	
	<select id="atrzAllSubmitList" resultMap="atrzMap" parameterType="string">
		SELECT 				/* AtrzMapper.atrzAllSubmitList 쿼리수정완료 */ 
		       A.atrz_doc_no
		      ,A.drafter_empno
		      ,A.drafter_clsf
		      ,A.drafter_empnm
		      ,A.drafter_dept
		      ,A.bkmk_yn
		      ,A.atch_file_no
		      ,A.atrz_sj
		      ,A.atrz_cn
		      ,A.atrz_opinion
		      ,A.atrz_tmpr_stre_dt
		      ,A.atrz_drft_dt
		      ,A.atrz_compt_dt
		      ,A.atrz_rtrvl_dt
		      ,A.atrz_sttus_code
		      ,A.eltsgn_image
		      ,A.doc_form_no
		      ,A.atrz_delete_yn
		      ,A.schdul_reg_yn
		      ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
              ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ A
		     LEFT JOIN atrz_line L
		       ON A.atrz_doc_no = L.atrz_doc_no
		WHERE 1=1
		  AND A.drafter_empno = #{emplNo}
		  AND A.atrz_delete_yn = 'N'
		   AND A.atrz_sttus_code IN ('00', '10', '20', '30', '40')
		ORDER BY a.atrz_drft_dt DESC
	</select>
	
	<!-- 결재완료문서 -->	
	<select id="atrzCompleteList" resultMap="atrzMap" parameterType="string">
		SELECT 				/* AtrzMapper.atrzCompleteList 쿼리수정완료 */ 
		       A.atrz_doc_no
		      ,A.drafter_empno
		      ,A.drafter_clsf
		      ,A.drafter_empnm
		      ,A.drafter_dept
		      ,A.bkmk_yn
		      ,A.atch_file_no
		      ,A.atrz_sj
		      ,A.atrz_cn
		      ,A.atrz_opinion
		      ,A.atrz_tmpr_stre_dt
		      ,A.atrz_drft_dt
		      ,A.atrz_compt_dt
		      ,A.atrz_rtrvl_dt
		      ,A.atrz_sttus_code
		      ,A.eltsgn_image
		      ,A.doc_form_no
		      ,A.atrz_delete_yn
		      ,A.schdul_reg_yn
		      ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
              ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ A
		     LEFT JOIN atrz_line L
		       ON A.atrz_doc_no = L.atrz_doc_no
		WHERE 1=1
		  AND A.drafter_empno = #{emplNo}
		  AND A.atrz_delete_yn = 'N'
		   AND A.atrz_sttus_code = 10
		ORDER BY a.atrz_drft_dt DESC
	</select>

	<!-- 임시저장한 문서리스트 (임시저장함) -->
	<select id="atrzStorageList"  resultMap="atrzMap" parameterType="string">
		SELECT /* AtrzMapper.atrzStorageList 쿼리수정완료 */
		          atrz_doc_no
		        , drafter_empno
		        , drafter_clsf
		        , drafter_empnm
		        , drafter_dept
		        , bkmk_yn
		        , atch_file_no
		        , atrz_sj, atrz_cn
		        , atrz_opinion
		        , atrz_tmpr_stre_dt
		        , atrz_drft_dt
		        , atrz_compt_dt
		        , atrz_rtrvl_dt
		        , atrz_sttus_code
		        , eltsgn_image
		        , doc_form_no
		        , atrz_delete_yn
		        , schdul_reg_yn
		        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
		        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ
		WHERE 1 = 1
			AND drafter_empno= #{emplNo}
			AND atrz_sttus_code	='99'
		ORDER BY atrz_tmpr_stre_dt DESC
	</select>
	
	<!-- 결재문서함 내가 결재한 문서의 한해서 결재 대기인 경우는 보이지않음-->
	<select id="atrzAllApprovalList" resultMap="atrzMap" parameterType="string">
		SELECT 	/* AtrzMapper.atrzAllApprovalList */
		      A.atrz_doc_no
		    , A.drafter_empno
		    , A.drafter_clsf
		    , A.drafter_empnm
		    , A.drafter_dept
		    , A.bkmk_yn
		    , A.atch_file_no
		    , A.atrz_sj
		    , A.atrz_cn
		    , A.atrz_opinion
		    , A.atrz_tmpr_stre_dT
		    , A.atrz_drft_dt
		    , A.atrz_compt_dt
		    , A.atrz_rtrvl_dt
		    , A.atrz_sttus_code
		    , A.eltsgn_image
		    , A.doc_form_no
		    , A.atrz_delete_yn
		    , A.schdul_reg_yn
    		,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
            ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ A
		        LEFT JOIN atrz_line L
		         ON A.atrz_doc_no = L.atrz_doc_no
		    WHERE 1=1
		    AND L.sanctner_empno = #{emplNo}
		    AND A.atrz_delete_yn = 'N'
		    AND L.atrz_ty = '1'
		    AND L.sanctn_progrs_sttus_code IN ('10','20','60')
		ORDER BY A.atrz_drft_dt DESC    
	</select>
	<!-- 반려문서함 -->
	<select id="atrzCompanionList" resultMap="atrzMap" parameterType="string">
		SELECT /* AtrzMapper.atrzCompanionList 쿼리수정완료 */
		         atrz_doc_no
		        , drafter_empno
		        , drafter_clsf
		        , drafter_empnm
		        , drafter_dept
		        , bkmk_yn
		        , atch_file_no
		        , atrz_sj, atrz_cn
		        , atrz_opinion
		        , atrz_tmpr_stre_dt
		        , atrz_drft_dt
		        , atrz_compt_dt
		        , atrz_rtrvl_dt
		        , atrz_sttus_code
		        , eltsgn_image
		        , doc_form_no
		        , atrz_delete_yn
		        , schdul_reg_yn
		        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'DEPARTMENT' AND CMMN_CODE = DRAFTER_DEPT) as DEPT_CODE_NM
		        ,(SELECT CMMN_CODE_NM FROM COMMON_CODE WHERE CMMN_CODE_GROUP = 'POSITION' AND CMMN_CODE = DRAFTER_CLSF) as CLSF_CODE_NM
		FROM ATRZ
		WHERE 1 = 1
			AND drafter_empno= #{emplNo}
			AND atrz_sttus_code	='20'
		ORDER BY atrz_tmpr_stre_dt DESC
	</select>
	
	

	<!-- 전자결재테이블 등록(결재선 지정 시 전자결재문서 번호를 생성해줌) 
			SELECT CREATE_DOC_NO(#{docFormNm}) AS CREATE_DOC_NO FROM DUAL
	-->
	<insert id="insertAtrz" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		<selectKey resultType="string" order="BEFORE" keyProperty="atrzDocNo">
			SELECT CREATE_DOC_NO(#{docFormNm}) FROM DUAL
		</selectKey>
	
		INSERT INTO     /* AtrzMapper.insertAtrz */
	<!-- 	전자결재번호, 기안자사번, 직급코드, 이름, 부서코드,  -->
			 atrz
		(
			  atrz_doc_no
			, drafter_empno
			, drafter_clsf
			, drafter_empnm
			, drafter_dept
			, bkmk_yn
			, doc_form_no
		)
		VALUES
		(
			#{atrzDocNo}
			,#{emplNo}
			,#{clsfCode}
			,#{emplNm}
			,#{deptCode}
			,'N'
			, #{docFormNo}
		)
	</insert>
	
	<!-- 전자결재테이블 등록(이미 전자결재 문서 번호가 존재함) 
	atrzSj, atrzCn, atrzDrftDt, atrzSttusCode
			AtrzVO(atrzDocNo=H_20250410_00003, drafterEmpno=null, drafterClsf=null, drafterEmpnm=null, drafterDept=null, bkmkYn=null, 
			atchFileNo=0, atrzSj=미리작성한 제목입니다., atrzCn=sfda, atrzOpinion=null, atrzTmprStreDt=null, atrzDrftDt=null, atrzComptDt=null,
			 atrzRtrvlDt=null, atrzSttusCode=null, eltsgnImage=null, docFormNo=1, atrzDeleteYn=null, schdulRegYn=null, docFormNm=H,
		emplNoArr=null, emplNo=20250004, emplNm=길준희, clsfCode=02, clsfCodeNm=null, deptCode=91, deptCodeNm=null, uploadFile=null,
		atrzLineVOList=null, holidayVO=null, spendingVO=null, emplDetailList=null)
	-->
	<update id="insertUpdateAtrz" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		UPDATE atrz     /* AtrzMapper.insertUpdateAtrz */
	<!-- 	첨부파일번호, 제목, 내용, 기안일시, 진행상태, 양식문서번호  -->
		SET   atrz_sttus_code = '00'
			, atrz_sj = #{atrzSj}
			, atrz_cn = #{atrzCn}
			, atrz_drft_dt = SYSDATE
			<if test="atchFileNo!=null and atchFileNo!=''">
				, atch_file_no = #{atchFileNo}
			</if>
        WHERE atrz_doc_no = #{atrzDocNo}		
	</update>
	
	<!-- 전자결재결재선 등록 -->
	<insert id="insertAtrzLine" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzLineVO">
		INSERT INTO  /* AtrzMapper.insertAtrzLine */
			atrz_line 
			(
			  atrz_doc_no
			, atrz_ln_sn
			, sanctner_empno
			, sanctner_clsf_code
			, atrz_ty
			, sanctn_progrs_sttus_code
			, dcrb_author_yn
			)
		VALUES
			(
			#{atrzDocNo}
			, #{atrzLnSn}
			, #{sanctnerEmpno}
			, #{sanctnerClsfCode}
			, #{atrzTy}
			, '00'
			, #{dcrbAuthorYn}
			)	
	</insert>
	
	<!-- 연차신청서 등록 -->
	<insert id="insertHoliday" parameterType="kr.or.ddit.sevenfs.vo.atrz.HolidayVO">
		<selectKey resultType="int" order="BEFORE" keyProperty="holiActplnNo">
			SELECT NVL(MAX(HOLI_ACTPLN_NO),0)+1 FROM DOCUM_HOLIDAY
		</selectKey>
		INSERT INTO /* AtrzMapper.insertHoliday */
			docum_holiday    
			(
			  HOLI_ACTPLN_NO
			, ATRZ_DOC_NO
			, HOLI_CODE
			, HOLI_START
			, HOLI_END
			, HOLI_USE_DAYS
			)
		VALUES
			(
			  #{holiActplnNo}
			, #{atrzDocNo}
			, #{holiCode}
			, #{holiStart}
			, #{holiEnd}
			, #{holiUseDays}
			)
	</insert>
	
	
	<select id="readHoCnt" parameterType="string" resultType="double">
		SELECT YRYC_REMNDR_DAYCNT
		FROM VACATION
		WHERE EMPL_NO = #{empNo}
		AND YRYC_YEAR = TO_CHAR(SYSDATE, 'YYYY')
	</select>
	
	<!-- 전자결재 임시저장 update -->
	<update id="storageHolidayUpdate" parameterType="AtrzVO">
	    UPDATE ATRZ
	    SET
	        ATRZ_SJ = #{atrzSj},
	        ATRZ_CN = #{atrzCn},
	        ATRZ_TMPR_STRE_DT = SYSDATE,
	        ATRZ_STTUS_CODE = '99'
	    WHERE ATRZ_DOC_NO = #{atrzDocNo}
	</update>
	
	
	<!-- 임시저장 결재선 인서트 -->
		<!-- 전자결재결재선 등록 -->
		<insert id="updateAtrzLine" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzLineVO">
			INSERT INTO  /* AtrzMapper.insertAtrzLine */
				atrz_line 
				(
				  atrz_doc_no
				, atrz_ln_sn
				, sanctner_empno
				, sanctner_clsf_code
				, atrz_ty
				, sanctn_progrs_sttus_code
				, dcrb_author_yn
				)
			VALUES
				(
				#{atrzDocNo}
				, #{atrzLnSn}
				, #{sanctnerEmpno}
				, #{sanctnerClsfCode}
				, #{atrzTy}
				, '00'
				, #{dcrbAuthorYn}
				)	
		</insert>
	
	<!-- 전자결재 임시저장 인서트 -->
	<insert id="atrzHolidayStorage" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
	       INSERT INTO 
	       			ATRZ (
		         ATRZ_DOC_NO,
		        ,DRAFTER_EMPNO
		        ,DRAFTER_CLSF
		        ,DRAFTER_EMPNM
		        ,DRAFTER_DEPT
		        ,ATRZ_SJ
		        ,ATRZ_CN
		        ,ATRZ_TMPR_STRE_DT
		        ,ATRZ_STTUS_CODE
		        ,DOC_FORM_NO
		    )
		    VALUES (
		         #{atrzDocNo},
		        ,#{drafterEmpno}
		        ,#{drafterClsf}
		        ,#{drafterEmpnm}
		        ,#{drafterDept}
		        ,#{atrzSj}
		        ,#{atrzCn}
		        ,SYSDATE
		        ,'99'
		        ,#{docFormNo}
		    )
	</insert>
	<!-- 연차신청서 임시저장 murge into -->
	<insert id="insertOrUpdateHoliday" parameterType="kr.or.ddit.sevenfs.vo.atrz.HolidayVO">
		<selectKey resultType="int" order="BEFORE" keyProperty="holiActplnNo">
			SELECT NVL(MAX(HOLI_ACTPLN_NO),0)+1 FROM DOCUM_HOLIDAY
		</selectKey>
	    MERGE INTO DOCUM_HOLIDAY A
	    USING (SELECT #{atrzDocNo} AS ATRZ_DOC_NO FROM dual) B
	    ON (A.ATRZ_DOC_NO = B.ATRZ_DOC_NO)
	    WHEN MATCHED THEN
	        UPDATE SET
	            HOLI_CODE = #{holiCode}
	            ,HOLI_START = #{holiStart}
	            ,HOLI_END = #{holiEnd}
	            ,HOLI_USE_DAYS = #{holiUseDays}
	    WHEN NOT MATCHED THEN
	        INSERT (
	        	  HOLI_ACTPLN_NO
	            , ATRZ_DOC_NO
	            , HOLI_CODE
	            , HOLI_START
	            , HOLI_END
	            , HOLI_USE_DAYS
	        ) VALUES (
		          #{holiActplnNo}
				, #{atrzDocNo}
	            , #{holiCode}
	            , #{holiStart}
	            , #{holiEnd}
	            , #{holiUseDays}
	        )
	</insert>
	
	
	<!-- 결재선 삭제 -->
	<delete id="deleteAtrzLineByDocNo" parameterType="string">
	    DELETE FROM ATRZ_LINE WHERE ATRZ_DOC_NO = #{atrzDocNo}
	</delete>
	
	<!-- 임시저장 select조회 상세보기 -->
		<!-- 전자결재(임시저장포함) 상세조회 -->
	<select id="getAtrzStorage" parameterType="string" resultMap="atrzMap">
		SELECT 	/* AtrzMapper.getAtrzStorage */
		     A.ATRZ_DOC_NO
		    ,A.DRAFTER_EMPNO
		    ,A.DRAFTER_CLSF
		    ,A.DRAFTER_EMPNM
		    ,A.DRAFTER_DEPT
		    ,A.BKMK_YN
		    ,A.ATCH_FILE_NO
		    ,A.ATRZ_SJ
		    ,A.ATRZ_CN
		    ,A.ATRZ_OPINION
		    ,A.ATRZ_TMPR_STRE_DT
		    ,A.ATRZ_DRFT_DT
		    ,A.ATRZ_COMPT_DT
		    ,A.ATRZ_RTRVL_DT
		    ,A.ATRZ_STTUS_CODE
		    ,A.ELTSGN_IMAGE
		    ,A.DOC_FORM_NO
		    ,A.ATRZ_DELETE_YN
		    ,A.SCHDUL_REG_YN
		    ,H.HOLI_ACTPLN_NO
		    ,H.HOLI_CODE
		    ,H.HOLI_START
		    ,H.HOLI_END
		    ,H.HOLI_USE_DAYS
		    ,S.SPENDING_REPORT_NO
		    ,S.EXPENSE_ORDER
		    ,S.EXPENSE_DATE
		    ,S.ITEM_DESCRIPTION
		    ,S.ITEM_QUANTITY
		    ,S.ITEM_AMOUNT
		    ,S.PAYMENT_METHOD
		    ,SL.SALARY_NO
		    ,SL.BASE_SALARY
		    ,SL.MEAL_ALLOWANCE
		    ,SL.INCOME_TAX
		    ,SL.LOCAL_TAX
		    ,SL.PENSION
		    ,SL.EMPLOYMENT_INS
		    ,SL.HEALTH_INS
		    ,SL.CARE_INS
		    ,SL.PAY_DATE
		    ,B.BANK_ACC_NO
		    ,B.OLD_BANK
		    ,B.OLD_ACC_NO
		    ,B.NEW_BANK
		    ,B.NEW_ACC_NO
		    ,B.REASON
		    ,D.DRAFT_NO
		    ,EC.EMP_CERT_NO
		    ,R.RESIGNATION_NO
		    ,L.ATRZ_LN_SN
		    ,L.SANCTNER_EMPNO
		    ,L.SANCTNER_CLSF_CODE
		    ,L.CONTD_EMPNO
		    ,L.CONTD_CLSF_CODE
		    ,L.DCRB_MAN_EMPNO
		    ,L.DCRB_MAN_CLSF_CODE
		    ,L.ATRZ_TY
		    ,L.SANCTN_PROGRS_STTUS_CODE
		    ,L.DCRB_AUTHOR_YN
		    ,L.CONTD_AUTHOR_YN
		    ,L.SANCTN_OPINION
		    ,L.ELTSGN_IMAGE AS LINE_ELTSGN_IMAGE
		    ,L.SANCTN_CONFM_DT
		
		FROM ATRZ A
		LEFT JOIN DOCUM_HOLIDAY H ON A.ATRZ_DOC_NO = H.ATRZ_DOC_NO
		LEFT JOIN DOCUM_SPENDING S ON A.ATRZ_DOC_NO = S.ATRZ_DOC_NO
		LEFT JOIN DOCUM_SALARY SL ON A.ATRZ_DOC_NO = SL.ATRZ_DOC_NO
		LEFT JOIN DOCUM_BANK_ACCOUNT B ON A.ATRZ_DOC_NO = B.ATRZ_DOC_NO
		LEFT JOIN DOCUM_DRAFT D ON A.ATRZ_DOC_NO = D.ATRZ_DOC_NO
		LEFT JOIN DOCUM_EMP_CERTIFICATE EC ON A.ATRZ_DOC_NO = EC.ATRZ_DOC_NO
		LEFT JOIN DOCUM_RESIGNATION R ON A.ATRZ_DOC_NO = R.ATRZ_DOC_NO
		LEFT JOIN ATRZ_LINE L ON A.ATRZ_DOC_NO = L.ATRZ_DOC_NO
		
		WHERE A.ATRZ_DOC_NO = #{atrzDocNo}
	</select>
	
	<!-- 연차신청서 임시저장후 업데이트 -->
	<update id="updateHolidayAtrz" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		    UPDATE ATRZ
		      SET 
		    	ATRZ_SJ = #{atrzSj}
		    	,ATRZ_CN = #{atrzCn}
		        ,DRAFTER_CLSF = #{clsfCode}
		        ,DRAFTER_DEPT = #{deptCode}
		        ,ATRZ_DRFT_DT = SYSDATE
		        ,ATRZ_STTUS_CODE = '10'
		    WHERE ATRZ_DOC_NO = #{atrzDocNo}
	</update>
	
	
	<!-- 연차신청서 임시저장상세정보 가져온후 다시 insert를 위한것 murge into -->
	<insert id="updateOrInsertHoliday" parameterType="kr.or.ddit.sevenfs.vo.atrz.HolidayVO">
	    MERGE INTO DOCUM_HOLIDAY A
	    USING (SELECT #{atrzDocNo} AS ATRZ_DOC_NO FROM dual) B
	    ON (A.ATRZ_DOC_NO = B.ATRZ_DOC_NO)
	    WHEN MATCHED THEN
	        UPDATE SET
	             HOLI_CODE = #{holiCode}
	            ,HOLI_START = #{holiStart}
	            ,HOLI_END = #{holiEnd}
	            ,HOLI_USE_DAYS = #{holiUseDays}
	    WHEN NOT MATCHED THEN
	        INSERT (
	        	  HOLI_ACTPLN_NO
	            , ATRZ_DOC_NO
	            , HOLI_CODE
	            , HOLI_START
	            , HOLI_END
	            , HOLI_USE_DAYS
	        ) VALUES (
		         #{holiActplnNo}
				, #{atrzDocNo}
	            , #{holiCode}
	            , #{holiStart}
	            , #{holiEnd}
	            , #{holiUseDays}
	        )
	</insert>
	<!-- 재기안시 문서정보가져오기 -->
	<select id="selectDocumentReturn" parameterType="string" resultMap="atrzMap">
	SELECT 	/* AtrzMapper.selectDocumentReturn */
	    A.ATRZ_DOC_NO
	    ,A.DRAFTER_EMPNO
	    ,A.DRAFTER_CLSF
	    ,A.DRAFTER_EMPNM
	    ,A.DRAFTER_DEPT
	    ,A.BKMK_YN
	    ,A.ATCH_FILE_NO
	    ,A.ATRZ_SJ
	    ,A.ATRZ_CN
	    ,A.ATRZ_OPINION
	    ,A.ATRZ_TMPR_STRE_DT
	    ,A.ATRZ_DRFT_DT
	    ,A.ATRZ_COMPT_DT
	    ,A.ATRZ_RTRVL_DT
	    ,A.ATRZ_STTUS_CODE
	    ,A.ELTSGN_IMAGE
	    ,A.DOC_FORM_NO
	    ,A.ATRZ_DELETE_YN
	    ,A.SCHDUL_REG_YN
	    ,H.HOLI_ACTPLN_NO
	    ,H.HOLI_CODE
	    ,H.HOLI_START
	    ,H.HOLI_END
	    ,H.HOLI_USE_DAYS
	    ,S.SPENDING_REPORT_NO
	    ,S.EXPENSE_ORDER
	    ,S.EXPENSE_DATE
	    ,S.ITEM_DESCRIPTION
	    ,S.ITEM_QUANTITY
	    ,S.ITEM_AMOUNT
	    ,S.PAYMENT_METHOD
	    ,SL.SALARY_NO
	    ,SL.BASE_SALARY
	    ,SL.MEAL_ALLOWANCE
	    ,SL.INCOME_TAX, SL.LOCAL_TAX
	    ,SL.PENSION, SL.EMPLOYMENT_INS
	    ,SL.HEALTH_INS
	    ,SL.CARE_INS
	    ,SL.PAY_DATE
	    ,B.BANK_ACC_NO
	    ,B.OLD_BANK
	    ,B.OLD_ACC_NO
	    ,B.NEW_BANK
	    ,B.NEW_ACC_NO
	    ,B.REASON
	    ,D.DRAFT_NO
	    ,EC.EMP_CERT_NO
	    ,R.RESIGNATION_NO
	    ,L.ATRZ_LN_SN
	    ,L.SANCTNER_EMPNO
	    ,L.SANCTNER_CLSF_CODE
	    ,L.CONTD_EMPNO
	    ,L.CONTD_CLSF_CODE
	    ,L.DCRB_MAN_EMPNO
	    ,L.DCRB_MAN_CLSF_CODE
	    ,L.ATRZ_TY
	    ,L.SANCTN_PROGRS_STTUS_CODE
	    ,L.DCRB_AUTHOR_YN
	    ,L.CONTD_AUTHOR_YN
	    ,L.SANCTN_OPINION
	    ,L.ELTSGN_IMAGE AS LINE_ELTSGN_IMAGE
	    ,L.SANCTN_CONFM_DT
	
	FROM ATRZ A
	LEFT JOIN DOCUM_HOLIDAY H ON A.ATRZ_DOC_NO = H.ATRZ_DOC_NO
	LEFT JOIN DOCUM_SPENDING S ON A.ATRZ_DOC_NO = S.ATRZ_DOC_NO
	LEFT JOIN DOCUM_SALARY SL ON A.ATRZ_DOC_NO = SL.ATRZ_DOC_NO
	LEFT JOIN DOCUM_BANK_ACCOUNT B ON A.ATRZ_DOC_NO = B.ATRZ_DOC_NO
	LEFT JOIN DOCUM_DRAFT D ON A.ATRZ_DOC_NO = D.ATRZ_DOC_NO
	LEFT JOIN DOCUM_EMP_CERTIFICATE EC ON A.ATRZ_DOC_NO = EC.ATRZ_DOC_NO
	LEFT JOIN DOCUM_RESIGNATION R ON A.ATRZ_DOC_NO = R.ATRZ_DOC_NO
	LEFT JOIN ATRZ_LINE L ON A.ATRZ_DOC_NO = L.ATRZ_DOC_NO
	
	WHERE A.ATRZ_DOC_NO = #{atrzDocNo}
	</select>
	
	
	
	<!-- 지출결의서 인서트  -->
	<insert id="insertSpending" parameterType="kr.or.ddit.sevenfs.vo.atrz.SpendingVO">
		<selectKey resultType="int" order="BEFORE" keyProperty="spendingReportNo">
			SELECT NVL(MAX(spending_report_no),0)+1 FROM docum_spending
		</selectKey>
		INSERT INTO /* AtrzMapper.insertSpending */
			docum_spending    
			(
			   spending_report_no
			 , atrz_doc_no
			 , expense_order
			 , expense_date
			 , item_description
			 , item_quantity
			 , item_amount
			 , payment_method
			)
		VALUES
			(
			  #{spendingReportNo}
			, #{atrzDocNo}
			, #{expenseOrder}
			, #{expenseDate}
			, #{itemDescription}
			, #{itemQuantity}
			, #{itemAmount}
			, #{paymentMethod}
			)
	</insert>
	
	<insert id="insertSalary" parameterType="kr.or.ddit.sevenfs.vo.atrz.SalaryVO">
		<selectKey resultType="int" order="BEFORE" keyProperty="salaryNo">
			SELECT NVL(MAX(salary_no),0)+1 FROM docum_salary
		</selectKey>
		INSERT INTO 	/* AtrzMapper.insertSalary */
			docum_salary
			(
			  salary_no
			, atrz_doc_no
			, base_salary
			, meal_allowance
			, income_tax
			, local_tax
			, pension
			, employment_ins
			, health_ins
			, care_ins, pay_date
			)
		VALUES
			(
			  #{salaryNo}
			, #{atrzDocNo}
			, #{baseSalary}
			, #{mealAllowance}
			, #{incomeTax}
			, #{localTax}
			, #{pension}
			, #{employmentIns}
			, #{healthIns}
			, #{careIns}
			, #{payDate}
			)
	</insert>
	
	<insert id="insertBankAccount" parameterType="kr.or.ddit.sevenfs.vo.atrz.BankAccountVO">
		<selectKey resultType="int" order="BEFORE" keyProperty="bankAccNo">
			SELECT NVL(MAX(bank_acc_no),0)+1 FROM docum_bank_account
		</selectKey>
		INSERT INTO 	/* AtrzMapper.insertBankAccount */
			docum_bank_account
			(
			   bank_acc_no
			 , atrz_doc_no
			 , old_bank
			 , old_acc_no
			 , new_bank
			 , new_acc_no
			 , reason
			)
		VALUES
			(
			  #{bankAccNo}
			, #{atrzDocNo}
			, #{oldBank}
			, #{oldAccNo}
			, #{newBank}
			, #{newAccNo}
			, #{reason}
			)
	</insert>
	
	<insert id="insertDraft" parameterType="kr.or.ddit.sevenfs.vo.atrz.DraftVO">
		<selectKey resultType="int" order="BEFORE" keyProperty="draftNo">
			SELECT NVL(MAX(draft_no),0)+1 FROM docum_draft
		</selectKey>
		INSERT INTO 	/* AtrzMapper.insertDraft */
			docum_draft
			(
			   atrz_doc_no
			 , draft_no
			)
		VALUES
			(
			  #{atrzDocNo}
			, #{draftNo}
			)
	</insert>
	
	<!-- 전자결재 상세조회 -->
	<select id="selectAtrzDetail" parameterType="string" resultMap="atrzMap">
		 SELECT 	/* AtrzMapper.selectAtrzDetail */
             A.ATRZ_DOC_NO
            ,A.DRAFTER_EMPNO
            ,A.DRAFTER_CLSF
            ,A.DRAFTER_EMPNM
            ,A.DRAFTER_DEPT
            ,A.BKMK_YN
            ,A.ATCH_FILE_NO
            ,A.ATRZ_SJ
            ,A.ATRZ_CN
            ,A.ATRZ_OPINION
            ,A.ATRZ_TMPR_STRE_DT
            ,A.ATRZ_DRFT_DT
            ,A.ATRZ_COMPT_DT
            ,A.ATRZ_RTRVL_DT
            ,A.ATRZ_STTUS_CODE
            ,A.ELTSGN_IMAGE
            ,A.DOC_FORM_NO
            ,A.ATRZ_DELETE_YN
            ,A.SCHDUL_REG_YN
            ,H.HOLI_ACTPLN_NO
            ,H.HOLI_CODE
            ,H.HOLI_START
            ,H.HOLI_END
            ,H.HOLI_USE_DAYS
            ,S.SPENDING_REPORT_NO
            ,S.EXPENSE_ORDER
            ,S.EXPENSE_DATE
            ,S.ITEM_DESCRIPTION
            ,S.ITEM_QUANTITY
            ,S.ITEM_AMOUNT
            ,S.PAYMENT_METHOD
            ,SL.SALARY_NO
            ,SL.BASE_SALARY
            ,SL.MEAL_ALLOWANCE
            ,SL.INCOME_TAX
            ,SL.LOCAL_TAX
            ,SL.PENSION
            ,SL.EMPLOYMENT_INS
            ,SL.HEALTH_INS
            ,SL.CARE_INS
            ,SL.PAY_DATE
            ,B.BANK_ACC_NO
            ,B.OLD_BANK
            ,B.OLD_ACC_NO
            ,B.NEW_BANK
            ,B.NEW_ACC_NO
            ,B.REASON
            ,D.DRAFT_NO
            ,EC.EMP_CERT_NO
            ,R.RESIGNATION_NO
        FROM ATRZ A
        LEFT JOIN DOCUM_HOLIDAY H ON A.ATRZ_DOC_NO = H.ATRZ_DOC_NO
        LEFT JOIN DOCUM_SPENDING S ON A.ATRZ_DOC_NO = S.ATRZ_DOC_NO
        LEFT JOIN DOCUM_SALARY SL ON A.ATRZ_DOC_NO = SL.ATRZ_DOC_NO
        LEFT JOIN DOCUM_BANK_ACCOUNT B ON A.ATRZ_DOC_NO = B.ATRZ_DOC_NO
        LEFT JOIN DOCUM_DRAFT D ON A.ATRZ_DOC_NO = D.ATRZ_DOC_NO
        LEFT JOIN DOCUM_EMP_CERTIFICATE EC ON A.ATRZ_DOC_NO = EC.ATRZ_DOC_NO
        LEFT JOIN DOCUM_RESIGNATION R ON A.ATRZ_DOC_NO = R.ATRZ_DOC_NO
        
        WHERE A.ATRZ_DOC_NO = #{atrzDocNo}
	</select>
	
	<!-- 전자결재선 상세보기 -->
	<select id="selectAtrzLineList" parameterType="string" resultType="kr.or.ddit.sevenfs.vo.atrz.AtrzLineVO">
		SELECT     /* AtrzMapper.selectAtrzLineList */
             ATRZ_DOC_NO
            ,ATRZ_LN_SN
            ,SANCTNER_EMPNO
            ,SANCTNER_CLSF_CODE
            ,CONTD_EMPNO
            ,CONTD_CLSF_CODE
            ,DCRB_MAN_EMPNO
            ,DCRB_MAN_CLSF_CODE
            ,ATRZ_TY
            ,SANCTN_PROGRS_STTUS_CODE
            ,DCRB_AUTHOR_YN
            ,CONTD_AUTHOR_YN
            ,SANCTN_OPINION
            ,ELTSGN_IMAGE
            ,SANCTN_CONFM_DT
        FROM ATRZ_LINE
        WHERE ATRZ_DOC_NO = #{atrzDocNo}
        ORDER BY ATRZ_LN_SN
	</select>
	
	<!-- 연차신청서 상세보기 -->
	<select id="holidayDetail" parameterType="string" resultType="kr.or.ddit.sevenfs.vo.atrz.HolidayVO">
		    SELECT *		/* AtrzMapper.holidayDetail */
			    FROM (
			        SELECT 
			            HOLI_ACTPLN_NO
			            ,ATRZ_DOC_NO
			            ,HOLI_CODE
			            ,HOLI_START
			            ,HOLI_END
			            ,HOLI_USE_DAYS
			            ,ROW_NUMBER() OVER (ORDER BY HOLI_ACTPLN_NO DESC) AS RN
			        FROM DOCUM_HOLIDAY
			        WHERE ATRZ_DOC_NO = #{atrzDocNo}
			    )
			    WHERE RN = 1
	</select>
	
	
	<!-- 나의 전자결재선 상황(1행)
	public AtrzLineVO getAtrzLineInfo(AtrzVO atrzVO) 
	나는 결재해야 하나?
	1) 전 결재자가 10, 40인가?
	
	AtrzVO(atrzDocNo=H_20250411_00003, drafterEmpno=null, drafterClsf=null, drafterEmpnm=null, drafterDept=null, bkmkYn=null, 
		 atchFileNo=0, atrzSj=null, atrzCn=null, atrzOpinion=null, atrzTmprStreDt=null, atrzDrftDt=null, atrzComptDt=null, atrzRtrvlDt=null, atrzSttusCode=null, 
		 eltsgnImage=null, docFormNo=0, atrzDeleteYn=null, schdulRegYn=null, docFormNm=null, emplNoArr=null, emplNo=20250000, emplNm=null, clsfCode=null, clsfCodeNm=null,
         deptCode=null, deptCodeNm=null, uploadFile=null, ..
	-->
	<select id="getAtrzLineInfo" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO" resultType="kr.or.ddit.sevenfs.vo.atrz.AtrzLineVO">
		WITH T AS(			/* AtrzMapper.getAtrzLineInfo */
		    SELECT A.ATRZ_LN_SN
		         , A.SANCTNER_EMPNO
		         , A.ATRZ_DOC_NO
		         , A.SANCTN_PROGRS_STTUS_CODE
		         , LAG(A.SANCTNER_EMPNO) OVER(ORDER BY A.ATRZ_LN_SN) BEF_SANCTNER_EMPNO
		         , LAG(A.SANCTN_PROGRS_STTUS_CODE) OVER(ORDER BY A.ATRZ_LN_SN) BEF_SANCTN_PROGRS_STTUS_CODE
		         , LEAD(A.SANCTNER_EMPNO) OVER(ORDER BY A.ATRZ_LN_SN) AFT_SANCTNER_EMPNO
		         , LEAD(A.SANCTN_PROGRS_STTUS_CODE) OVER(ORDER BY A.ATRZ_LN_SN) AFT_SANCTN_PROGRS_STTUS_CODE
		         , (SELECT MAX(B.ATRZ_LN_SN) FROM ATRZ_LINE B WHERE B.ATRZ_DOC_NO = #{atrzDocNo} AND B.DCRB_AUTHOR_YN = '0') MAX_ATRZ_LN_SN
		    FROM   ATRZ_LINE A
		    WHERE  A.ATRZ_DOC_NO = #{atrzDocNo}
		)
		SELECT T.*
		FROM T
		WHERE  T.SANCTNER_EMPNO = #{emplNo}
	</select>
	
	<!--H_20250411_00003 문서의 결재선 총 스탭수
	public int getMaxStep(AtrzVO atrzVO) 

	0 : 최종결재자가 아님
	 -->
	<select id="getMaxStep" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO" resultType="int">
		SELECT
		    CASE 
		        WHEN AL.ATRZ_LN_SN = MAX_LINE.MAX_LN_SN THEN AL.ATRZ_LN_SN
		        ELSE 0
		    END AS RSLT
		FROM (
		    SELECT ATRZ_DOC_NO, TO_NUMBER(ATRZ_LN_SN) AS ATRZ_LN_SN
		    FROM ATRZ_LINE
		    WHERE ATRZ_DOC_NO = #{atrzDocNo}
		      AND SANCTNER_EMPNO = #{emplNo}
		      AND ATRZ_TY = '1'  /* 결재자만 */
		) AL
		LEFT JOIN (
		    SELECT ATRZ_DOC_NO, MAX(TO_NUMBER(ATRZ_LN_SN)) AS MAX_LN_SN
		    FROM ATRZ_LINE
		    WHERE ATRZ_DOC_NO = #{atrzDocNo}
		      AND ATRZ_TY = '1'  /* 결재자만 고려 */
		    GROUP BY ATRZ_DOC_NO
		) MAX_LINE ON AL.ATRZ_DOC_NO = MAX_LINE.ATRZ_DOC_NO
	</select>
	
	<!-- 전자결재선 수정
		 AtrzVO(atrzDocNo=H_20250411_00003, drafterEmpno=null, drafterClsf=null, drafterEmpnm=null, drafterDept=null, bkmkYn=null, 
		 atchFileNo=0, atrzSj=null, atrzCn=null, atrzOpinion=null, atrzTmprStreDt=null, atrzDrftDt=null, atrzComptDt=null, atrzRtrvlDt=null, atrzSttusCode=null, 
		 eltsgnImage=null, docFormNo=0, atrzDeleteYn=null, schdulRegYn=null, docFormNm=null, emplNoArr=null, emplNo=20250000, emplNm=null, clsfCode=null, clsfCodeNm=null,
         deptCode=null, deptCodeNm=null, uploadFile=null, 
		  	atrzLineVOList=[AtrzLineVO(atrzDocNo=null, atrzLnSn=0, sanctnerEmpno=null, sanctnerClsfCode=null, contdEmpno=null, 
			  contdClsfCode=null, dcrbManEmpno=null, dcrbManClsfCode=null, atrzTy=null, sanctnProgrsSttusCode=null, dcrbAuthorYn=null, contdAuthorYn=null, 
			  sanctnOpinion=승인합니다.,eltsgnImage=null, sanctnConfmDt=null, atrzLineList=null, sanctnerClsfNm=null, sanctnerEmpNm=null)
			  ], 
		 holidayVO=null, spendingVO=null, salaryVO=null, 
		 bankAccountVO=null, draftVO=null, emplDetailList=null, authorStatus=false, sanctnProgrsSttusCode=10)
	 -->
	 <!-- 결재승인시 -->
	<update id="atrzDetailAppUpdate" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		UPDATE atrz_line  /* AtrzMapper.atrzDetailAppUpdate */
		SET 
			 SANCTN_PROGRS_STTUS_CODE = 10
			,SANCTN_CONFM_DT = SYSDATE
			,SANCTN_OPINION = #{atrzLineVOList[0].sanctnOpinion}
		WHERE ATRZ_DOC_NO = #{atrzDocNo} AND SANCTNER_EMPNO = #{emplNo}
	</update>
	
	<!-- 전자결재문서 수정 -->
	<update id="atrzStatusFinalUpdate" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		UPDATE ATRZ /* AtrzMapper.atrzStatusFinalUpdate */
		SET 
			 ATRZ_STTUS_CODE = #{atrzSttusCode}
			,ATRZ_COMPT_DT = SYSDATE
		WHERE ATRZ_DOC_NO = #{atrzDocNo}
	</update>
	
	 <!-- 결재 반려시 -->
	<update id="atrzDetilCompUpdate" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		BEGIN
		UPDATE atrz_line  /* AtrzMapper.atrzDetailAppUpdate */
		SET 
			 SANCTN_PROGRS_STTUS_CODE = 20
			,SANCTN_CONFM_DT = SYSDATE
			,SANCTN_OPINION = #{atrzLineVOList[0].sanctnOpinion}
		WHERE ATRZ_DOC_NO = #{atrzDocNo} 
		AND SANCTNER_EMPNO = #{emplNo};
		
		UPDATE ATRZ
		 SET ATRZ_STTUS_CODE = 20
			,ATRZ_COMPT_DT = SYSDATE
			,ATRZ_OPINION = #{atrzLineVOList[0].sanctnOpinion}
		WHERE ATRZ_DOC_NO = #{atrzDocNo};
		END;
	</update>
	
	 <!-- 기안취소시 전자결재선   -->
	<update id="atrzLineCancelUpdate" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
		UPDATE ATRZ_LINE  	/* AtrzMapper.atrzLineCancelUpdate */
		SET 
		    sanctn_progrs_sttus_code = '30',
		    sanctn_confm_dt = SYSDATE
		WHERE atrz_doc_no = #{atrzDocNo}
		  AND EXISTS (
		      SELECT 1
		      FROM DUAL
		      WHERE EXISTS (
		          SELECT 1 FROM ATRZ
		          WHERE atrz_doc_no = #{atrzDocNo}
		            AND drafter_empno = #{emplNo}
		      )
		  )
	</update>
	
	<!-- 기안취소시 전자결재   -->
	<update id="atrzCancelUpdate" parameterType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO">
			UPDATE ATRZ			/* AtrzMapper.atrzCancelUpdate */
			SET 
			     atrz_sttus_code = '30'
			    ,atrz_rtrvl_dt = SYSDATE
			WHERE atrz_doc_no = #{atrzDocNo}
			  AND drafter_empno = #{emplNo}
	</update>
	
	<!-- 연차신청서 최종 결재 완료시 -->
	<select id="selectHolidayByDocNo" resultMap="holidayDetailMap">
	    SELECT 				/* AtrzMapper.selectHolidayByDocNo */
	         H.HOLI_ACTPLN_NO
	        ,H.ATRZ_DOC_NO
	        ,H.HOLI_CODE
	        ,H.HOLI_START
	        ,H.HOLI_END
	        ,H.HOLI_USE_DAYS
	        /* AtrzVO에 필요한 컬럼들 (resultMap에서 참조하는 것들) */
	        ,A.ATCH_FILE_NO
	        ,A.ATRZ_CN
	        ,A.ATRZ_COMPT_DT
	        ,A.ATRZ_DELETE_YN
	        ,A.ATRZ_DRFT_DT
	        ,A.ATRZ_OPINION
	        ,A.ATRZ_RTRVL_DT
	        ,A.ATRZ_SJ
	        ,A.ATRZ_STTUS_CODE
	        ,A.ATRZ_TMPR_STRE_DT
	        ,A.BKMK_YN
	        ,A.DOC_FORM_NO
	        ,A.DRAFTER_CLSF
	        ,A.DRAFTER_DEPT
	        ,A.DRAFTER_EMPNM
	        ,A.DRAFTER_EMPNO
	        ,A.ELTSGN_IMAGE
	        ,A.SCHDUL_REG_YN
	    FROM DOCUM_HOLIDAY H
	    LEFT JOIN ATRZ A ON H.ATRZ_DOC_NO = A.ATRZ_DOC_NO
	    WHERE H.ATRZ_DOC_NO = #{atrzDocNo}
	</select>


	<!-- 연차신청서 기안완료시 근태현황 인서트 -->
	<insert id="holidayDclzUpdate" parameterType="kr.or.ddit.sevenfs.vo.organization.DclzTypeVO">
		    INSERT INTO  /* AtrzMapper.holidayDclzUpdate */
		    DCLZ_TYPE 
		    (		
		         EMPL_NO
		        ,DCLZ_NO
		        ,DCLZ_CODE
		        ,DCLZ_BEGIN_DT
		        ,DCLZ_END_DT
		        ,DCLZ_REASON
		    ) VALUES (
		         #{emplNo}
		        ,#{dclzNo}
		        ,#{dclzCode}
		        ,#{dclzBeginDt}
		        ,#{dclzEndDt}
		        ,#{dclzReason}
		    )
	</insert>
	<!-- 연차신청서 기안완료시 연차갯수 소진시키기 -->
	<update id="updateVacationUseDays" parameterType="kr.or.ddit.sevenfs.vo.organization.VacationVO">
	    UPDATE vacation   /* AtrzMapper.updateVacationUseDays */
		    SET 
		        yryc_use_daycnt =  #{yrycUseDaycnt}
		        ,yryc_remndr_daycnt =  #{yrycRemndrDaycnt}
		    WHERE empl_no = #{emplNo}
		    AND YRYC_YEAR = TO_CHAR(SYSDATE, 'YYYY')
	</update>
	<!-- 기안자의 연차정보 가져오기 -->
	<select id="emplVacationCnt" parameterType="string" resultType="kr.or.ddit.sevenfs.vo.organization.VacationVO">
		SELECT 				/* AtrzMapper.emplVacationCnt */
			    EMPL_NO
			, YRYC_YEAR
			, YRYC_USE_BEGIN_DATE
			, YRYC_USE_END_DATE
			, TOT_YRYC_DAYCNT
			, YRYC_USE_DAYCNT
			, YRYC_MDAT_DAYCNT
			, YRYC_REMNDR_DAYCNT
			, EXCESS_WORK_YRYC
			, CMPNSTN_YRYC
			, YRYC_CODE
			, YRYC_DETAIL
			FROM VACATION
			WHERE 1 = 1
			AND EMPL_NO = #{emplNo}
			AND YRYC_YEAR = TO_CHAR(SYSDATE, 'YYYY')
	</select>
	
	<!-- 임시저장 결재선 삭제 -->
	<delete id="deleteStorageAtrzLines">
		 DELETE FROM ATRZ_LINE WHERE ATRZ_DOC_NO IN
	    <foreach collection="atrzDocNos" item="atrzDocNo" open="(" separator="," close=")">
	        #{atrzDocNo}
	    </foreach>
	</delete>
	
	<!-- 임시저장 연차신청서 삭제 -->
	<delete id="deleteStorageDocumHoliday">
		 DELETE FROM DOCUM_HOLIDAY WHERE ATRZ_DOC_NO IN
	    <foreach collection="atrzDocNos" item="atrzDocNo" open="(" separator="," close=")">
	        #{atrzDocNo}
	    </foreach>
	</delete>
	
	<!-- 임시저장 결재선 삭제 -->
	<delete id="deleteStorageAtrz">
		 DELETE FROM ATRZ WHERE ATRZ_DOC_NO IN
	    <foreach collection="atrzDocNos" item="atrzDocNo" open="(" separator="," close=")">
	        #{atrzDocNo}
	    </foreach>
	</delete>
	
	<!-- ATRZ_LINE 삭제 -->
	<delete id="deleteAtrzLineWriting" parameterType="string">
	    DELETE FROM ATRZ_LINE
	    WHERE ATRZ_DOC_NO = #{atrzDocNo}
	</delete>
	
	<!-- ATRZ 삭제 -->
	<delete id="deleteAtrzWriting" parameterType="string">
	    DELETE FROM ATRZ
	    WHERE ATRZ_DOC_NO = #{atrzDocNo}
	</delete>
	
	
	
	<!-- 연차신청서 resultMap 사용 -->
	<resultMap id="holidayDetailMap" type="kr.or.ddit.sevenfs.vo.atrz.HolidayVO" >
		<!-- 연차신청서 -->
		<id property="holiActplnNo" column="HOLI_ACTPLN_NO"/>
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<result property="holiCode" column="HOLI_CODE"/>
		<result property="holiStart" column="HOLI_START"/>
		<result property="holiEnd" column="HOLI_END"/>
		<result property="holiUseDays" column="HOLI_USE_DAYS"/>
		<result property="holiDelete" column="HOLI_DELETE"/>
		<association property="atrzVO" resultMap="atrzMap"></association>
	</resultMap>

	<!-- 지출결의서 resultMap -->
	<resultMap id="spendingDetailMap" type="kr.or.ddit.sevenfs.vo.atrz.SpendingVO" >
		<result property="spendingReportNo" column="SPENDING_REPORT_NO"/>
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<result property="expenseOrder" column="EXPENSE_ORDER"/>
		<result property="expenseDate" column="EXPENSE_DATE"/>
		<result property="itemDescription" column="ITEM_DESCRIPTION"/>
		<result property="itemQuantity" column="ITEM_QUANTITY"/>
		<result property="itemAmount" column="ITEM_AMOUNT"/>
		<result property="paymentMethod" column="PAYMENT_METHOD"/>
		<association property="atrzVO" resultMap="atrzMap"></association>
	</resultMap>
	
	<!-- 급여명세서 resultMap -->
	<resultMap id="salaryDetailMap" type="kr.or.ddit.sevenfs.vo.atrz.SalaryVO">
		<result property="salaryNo" column="SALARY_NO"/>
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<result property="baseSalary" column="BASE_SALARY"/>
		<result property="mealAllowance" column="MEAL_ALLOWANCE"/>
		<result property="incomeTax" column="INCOME_TAX"/>
		<result property="localTax" column="LOCAL_TAX"/>
		<result property="pension" column="PENSION"/>
		<result property="employmentIns" column="EMPLOYMENT_INS"/>
		<result property="healthIns" column="HEALTH_INS"/>
		<result property="careIns" column="CARE_INS"/>
		<association property="atrzVO" resultMap="atrzMap"></association>
	</resultMap>
	
	<!-- 급여계좌변경신청서 resultMap -->
	<resultMap id="bankAccountDetailMap" type="kr.or.ddit.sevenfs.vo.atrz.BankAccountVO">
		<result property="bankAccNo" column="BANK_ACC_NO"/>
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<result property="oldBank" column="OLD_BANK"/>
		<result property="oldAccNo" column="OLD_ACC_NO"/>
		<result property="newBank" column="NEW_BANK"/>
		<result property="newAccNo" column="NEW_ACC_NO"/>
		<result property="reason" column="REASON"/>
		<association property="atrzVO" resultMap="atrzMap"></association>
	</resultMap>
	
	<!-- 기안서 resultMap -->
	<resultMap id="draftDetailMap" type="kr.or.ddit.sevenfs.vo.atrz.DraftVO" >
		<result property="draftNo" column="DRAFT_NO"/>
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<association property="atrzVO" resultMap="atrzMap"></association>
	</resultMap>
	
	<!-- 전자결재 -->
	<resultMap type="kr.or.ddit.sevenfs.vo.atrz.AtrzVO" id="atrzMap">
		<result property="atchFileNo" column="ATCH_FILE_NO"/>
		<result property="atrzCn" column="ATRZ_CN"/>
		<result property="atrzComptDt" column="ATRZ_COMPT_DT"/>
		<result property="atrzDeleteYn" column="ATRZ_DELETE_YN"/>
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<result property="atrzDrftDt" column="ATRZ_DRFT_DT"/>
		<result property="atrzOpinion" column="ATRZ_OPINION"/>
		<result property="atrzRtrvlDt" column="ATRZ_RTRVL_DT"/>
		<result property="atrzSj" column="ATRZ_SJ"/>
		<result property="atrzSttusCode" column="ATRZ_STTUS_CODE"/>
		<result property="atrzTmprStreDt" column="ATRZ_TMPR_STRE_DT"/>
		<result property="bkmkYn" column="BKMK_YN"/>
		<result property="docFormNo" column="DOC_FORM_NO"/>
		<result property="drafterClsf" column="DRAFTER_CLSF"/>
		<result property="drafterDept" column="DRAFTER_DEPT"/>
		<result property="drafterEmpnm" column="DRAFTER_EMPNM"/>
		<result property="drafterEmpno" column="DRAFTER_EMPNO"/>
		<result property="eltsgnImage" column="ELTSGN_IMAGE"/>
		<result property="schdulRegYn" column="SCHDUL_REG_YN"/>
		<result property="clsfCodeNm" column="CLSF_CODE_NM"/>
		<result property="deptCodeNm" column="DEPT_CODE_NM"/>
		<collection property="atrzLineVOList" resultMap="atrzLineMap"></collection>
	</resultMap>
	
	<!-- 전자결재선 -->
	<resultMap type="kr.or.ddit.sevenfs.vo.atrz.AtrzLineVO" id="atrzLineMap">
		<result property="atrzDocNo" column="ATRZ_DOC_NO"/>
		<result property="atrzLnSn" column="ATRZ_LN_SN"/>
		<result property="sanctnerEmpno" column="SANCTNER_EMPNO"/>
		<result property="sanctnerClsfCode" column="SANCTNER_CLSF_CODE"/>
		<result property="contdEmpno" column="CONTD_EMPNO"/>
		<result property="contdClsfCode" column="CONTD_CLSF_CODE"/>
		<result property="dcrbManEmpno" column="DCRB_MAN_EMPNO"/>
		<result property="dcrbManClsfCode" column="DCRB_MAN_CLSF_CODE"/>
		<result property="atrzTy" column="ATRZ_TY"/>
		<result property="sanctnProgrsSttusCode" column="SANCTN_PROGRS_STTUS_CODE"/>
		<result property="dcrbAuthorYn" column="DCRB_AUTHOR_YN"/>
		<result property="contdAuthorYn" column="CONTD_AUTHOR_YN"/>
		<result property="sanctnOpinion" column="SANCTN_OPINION"/>
		<result property="eltsgnImage" column="ELTSGN_IMAGE"/>
		<result property="sanctnConfmDt" column="SANCTN_CONFM_DT"/>
	</resultMap>
	
	<!-- 사원 -->
	<resultMap id="EmployeeResultMap" type="kr.or.ddit.sevenfs.vo.organization.EmployeeVO">
       <id property="emplNo" column="EMPL_NO"/>
      <result property="emplNm" column="EMPL_NM"/>
       <result property="deptCode" column="DEPT_CODE"/>
       <result property="clsfCode" column="CLSF_CODE"/>
       <!-- 전자결재 리스트 -->
       <collection property="EmplAtrzList" ofType="kr.or.ddit.sevenfs.vo.atrz.AtrzVO" resultMap="atrzMap"/>
    </resultMap>
	
	
</mapper>